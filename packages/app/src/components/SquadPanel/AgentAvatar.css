/**
 * AgentAvatar Styles
 * Character visual with expression states and aura effects
 *
 * Performance: Uses transform/opacity only for animations
 * Dark theme: #1a1a1a/#1e1e1e backgrounds, #3c3c3c borders
 */

/* ===== BASE AVATAR CONTAINER ===== */

.agent-avatar {
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.05), rgba(0, 0, 0, 0.2));
  transition: transform 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
  --glow-color: #ffffff;
}

/* Size variants */
.agent-avatar.size-orchestrator {
  width: 140px;
  height: 140px;
}

.agent-avatar.size-subagent {
  width: 100px;
  height: 100px;
}

/* Hover state - scale and brighten */
.agent-avatar.is-hovered {
  transform: scale(1.1);
}

.agent-avatar.is-hovered .avatar-aura {
  opacity: 0.9;
}

/* ===== AURA LAYER ===== */

.avatar-aura {
  position: absolute;
  inset: -8px;
  border-radius: 50%;
  border: 2px solid var(--glow-color);
  opacity: 0.6;
  transition: opacity 0.3s ease, box-shadow 0.3s ease;
  pointer-events: none;
  box-shadow: 0 0 12px var(--glow-color);
}

/* Idle aura - slow, dim pulse */
.avatar-aura.aura-idle {
  animation: auraPulseIdle 3s ease-in-out infinite;
}

@keyframes auraPulseIdle {
  0%, 100% {
    opacity: 0.5;
    transform: scale(1);
  }
  50% {
    opacity: 0.7;
    transform: scale(1.05);
  }
}

/* Thinking aura - medium rhythm, contemplative */
.avatar-aura.aura-thinking {
  animation: auraPulseThinking 2s ease-in-out infinite;
}

@keyframes auraPulseThinking {
  0%, 100% {
    opacity: 0.6;
    transform: scale(1);
  }
  50% {
    opacity: 0.85;
    transform: scale(1.08);
  }
}

/* Working aura - steady, bright */
.avatar-aura.aura-working {
  animation: auraPulseWorking 1.5s ease-in-out infinite;
  opacity: 0.85;
}

@keyframes auraPulseWorking {
  0%, 100% {
    opacity: 0.8;
    transform: scale(1);
  }
  50% {
    opacity: 1;
    transform: scale(1.1);
  }
}

/* Waiting aura - slow breathe, patient */
.avatar-aura.aura-waiting {
  animation: auraPulseWaiting 2.5s ease-in-out infinite;
}

@keyframes auraPulseWaiting {
  0%, 100% {
    opacity: 0.5;
    transform: scale(1.02);
  }
  50% {
    opacity: 0.75;
    transform: scale(1.08);
  }
}

/* Success aura - quick sparkle burst then fade */
.avatar-aura.aura-success {
  animation: auraBurst 1.2s ease-out;
  opacity: 0.8;
}

@keyframes auraBurst {
  0% {
    opacity: 1;
    transform: scale(0.8);
  }
  50% {
    opacity: 1;
    transform: scale(1.15);
  }
  100% {
    opacity: 0.4;
    transform: scale(1);
  }
}

/* Error aura - frantic flicker */
.avatar-aura.aura-error {
  animation: auraFlicker 0.6s ease-in-out infinite;
}

@keyframes auraFlicker {
  0%, 100% {
    opacity: 0.3;
    transform: scale(0.95);
  }
  25% {
    opacity: 0.9;
    transform: scale(1.12);
  }
  50% {
    opacity: 0.2;
    transform: scale(0.9);
  }
  75% {
    opacity: 0.8;
    transform: scale(1.1);
  }
}

/* Spawning aura - energetic release */
.avatar-aura.aura-spawning {
  animation: auraSpawn 1s ease-out;
  opacity: 0.9;
}

@keyframes auraSpawn {
  0% {
    opacity: 0;
    transform: scale(0.5);
  }
  60% {
    opacity: 1;
    transform: scale(1.2);
  }
  100% {
    opacity: 0.7;
    transform: scale(1);
  }
}

/* ===== CHARACTER CONTAINER ===== */

.avatar-character {
  position: relative;
  z-index: 10;
  width: 100%;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: floatDefault 3s ease-in-out infinite;
}

/* Float animation - gentle bobbing motion */
@keyframes floatDefault {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-4px);
  }
}

/* Expression states alter float and body pose */

.agent-avatar.expression-idle .avatar-character {
  animation: floatDefault 3s ease-in-out infinite;
}

.agent-avatar.expression-thinking .avatar-character {
  animation: floatThinking 3.5s ease-in-out infinite;
}

@keyframes floatThinking {
  0%, 100% {
    transform: translateY(0px);
  }
  50% {
    transform: translateY(-6px);
  }
}

.agent-avatar.expression-working .avatar-character {
  animation: floatWorking 2s ease-in-out infinite;
}

@keyframes floatWorking {
  0%, 100% {
    transform: translateY(-2px);
  }
  50% {
    transform: translateY(2px);
  }
}

.agent-avatar.expression-error .avatar-character {
  animation: joltError 0.5s ease-in-out;
}

@keyframes joltError {
  0%, 100% {
    transform: translateY(0px) translateX(0px);
  }
  25% {
    transform: translateY(-4px) translateX(-3px);
  }
  50% {
    transform: translateY(4px) translateX(3px);
  }
  75% {
    transform: translateY(-2px) translateX(-2px);
  }
}

/* ===== SVG CONTENT ===== */

.avatar-svg {
  width: 100%;
  height: 100%;
  max-width: 80%;
  max-height: 80%;
  filter: drop-shadow(0 0 8px currentColor);
  z-index: 1;
}

/* Mouth expressions based on status */
.avatar-mouth {
  transition: d 0.3s ease;
}

/* Idle/waiting: relaxed mouth */
.agent-avatar.expression-idle .avatar-mouth,
.agent-avatar.expression-waiting .avatar-mouth {
  d: path('M 40 55 Q 50 63 60 55');
  stroke-width: 2.5;
}

/* Thinking: contemplative closed or upturned */
.agent-avatar.expression-thinking .avatar-mouth {
  d: path('M 40 60 Q 50 60 60 60');
  stroke-width: 2;
  opacity: 0.7;
}

/* Working: determined or smiling */
.agent-avatar.expression-working .avatar-mouth {
  d: path('M 38 55 Q 50 68 62 55');
  stroke-width: 2.5;
}

/* Success: big smile */
.agent-avatar.expression-success .avatar-mouth {
  d: path('M 35 52 Q 50 70 65 52');
  stroke-width: 3;
}

/* Error: worried/open */
.agent-avatar.expression-error .avatar-mouth {
  d: path('M 40 60 Q 50 50 60 60');
  stroke-width: 2.5;
}

/* Spawning: concentrated/focused */
.agent-avatar.expression-spawning .avatar-mouth {
  d: path('M 40 60 L 60 60');
  stroke-width: 2;
}

/* ===== EMOJI FALLBACK ===== */

.avatar-emoji {
  position: absolute;
  font-size: clamp(24px, 40%, 48px);
  line-height: 1;
  opacity: 0.3;
  z-index: 0;
  pointer-events: none;
  filter: blur(0.5px);
}

/* ===== STATUS INDICATOR ===== */

.avatar-status-dot {
  position: absolute;
  bottom: 4px;
  right: 4px;
  width: 10px;
  height: 10px;
  border-radius: 50%;
  z-index: 20;
  transition: all 0.3s ease;
}

.agent-avatar.is-hovered .avatar-status-dot {
  width: 12px;
  height: 12px;
  bottom: 2px;
  right: 2px;
}

/* ===== BLINK ANIMATION ===== */

/* Eyes blink on idle/waiting states */
@keyframes blink {
  0%, 95%, 100% {
    cy: 35;
  }
  97% {
    cy: 40;
  }
}

.agent-avatar.expression-idle circle[cx='35'][cy='35'],
.agent-avatar.expression-waiting circle[cx='35'][cy='35'],
.agent-avatar.expression-idle circle[cx='65'][cy='35'],
.agent-avatar.expression-waiting circle[cx='65'][cy='35'] {
  animation: blink 4s ease-in-out infinite;
}

/* ===== STATUS-BASED ANIMATIONS (from animations.css) ===== */

/* Apply idle animation (float + blink) */
.agent-avatar-idle .avatar-character {
  animation: agent-float 3s var(--ease-natural) infinite;
}

/* Apply thinking animation (sway) */
.agent-avatar-thinking .avatar-character {
  animation: agent-sway 2.5s var(--ease-ghibli) infinite;
}

/* Apply working animation (pulse) */
.agent-avatar-working .avatar-character {
  animation: agent-pulse 1.5s var(--ease-natural) infinite;
}

/* Apply success animation (sparkle - play once) */
.agent-avatar-success .avatar-character {
  animation: agent-sparkle 0.8s var(--ease-bounce);
}

/* Apply error animation (jolt - play once) */
.agent-avatar-error .avatar-character {
  animation: agent-jolt 0.5s var(--ease-natural);
}

/* Apply spawning animation (materialize - play once) */
.agent-avatar-spawning .avatar-character {
  animation: agent-spawn 1s var(--ease-ghibli);
}

/* ===== AURA STATUS ANIMATIONS ===== */

/* Idle aura - slow pulse */
.agent-aura-idle {
  animation: aura-pulse-idle 3s var(--ease-natural) infinite;
}

/* Working/thinking aura - active pulse */
.agent-aura-working,
.agent-aura-thinking {
  animation: aura-pulse-active 1.8s var(--ease-natural) infinite;
}

/* Error aura - flicker */
.agent-aura-error {
  animation: aura-pulse-error 0.6s ease-in-out infinite;
}

/* Success aura - brief bright pulse */
.agent-aura-success {
  animation: aura-pulse-active 1s var(--ease-bounce);
}

/* Spawning aura - bright fade-in */
.agent-aura-spawning {
  animation: aura-pulse-active 1s var(--ease-ghibli);
}

/* ===== ACCESSIBILITY ===== */

/* Respect prefers-reduced-motion */
@media (prefers-reduced-motion: reduce) {
  .agent-avatar,
  .avatar-aura,
  .avatar-character,
  .avatar-mouth {
    animation: none !important;
    transition: none !important;
  }

  .agent-avatar.is-hovered {
    transform: scale(1.05);
  }
}

/* ===== DARK THEME INTEGRATION ===== */

.agent-avatar {
  background: radial-gradient(circle at 35% 35%, rgba(255, 255, 255, 0.08), rgba(0, 0, 0, 0.4));
}

/* High contrast for dark backgrounds */
.agent-avatar .avatar-svg {
  filter: drop-shadow(0 0 12px currentColor);
}

/* ===== RESPONSIVE SIZING ===== */

/* Full layout (â‰¥1200px) */
@media (min-width: 1200px) {
  .agent-avatar.size-orchestrator {
    width: 160px;
    height: 160px;
  }

  .agent-avatar.size-subagent {
    width: 110px;
    height: 110px;
  }
}

/* Compact layout (768-1199px) */
@media (min-width: 768px) and (max-width: 1199px) {
  .agent-avatar.size-orchestrator {
    width: 150px;
    height: 150px;
  }

  .agent-avatar.size-subagent {
    width: 105px;
    height: 105px;
  }
}

/* Icon grid (< 768px) - all avatars same size */
@media (max-width: 767px) {
  .agent-avatar.size-orchestrator,
  .agent-avatar.size-subagent {
    width: 100px;
    height: 100px;
  }
}

/* Very narrow (< 480px) */
@media (max-width: 479px) {
  .agent-avatar.size-orchestrator,
  .agent-avatar.size-subagent {
    width: 85px;
    height: 85px;
  }

  .avatar-emoji {
    font-size: clamp(18px, 35%, 36px);
  }
}
